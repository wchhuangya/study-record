[TOC]

批处理文件中有两种类型的变量。一种是用于参数，当批处理文件被调用时可以传递这些参数，另一种是通过set命令完成的。

# 命令行参数

批处理脚本支持命令行参数的概念，其中参数可以在调用时传递给批处理文件。可以在调用时通过变量%1、%2、%3等将参数的值传递给批处理文件。

下面的示例显示了一个批处理文件，它接受3个命令行参数，并将它们回显到命令行屏幕上：

```shell
@echo off 
echo %1 
echo %2 
echo %3
pause
```

如果上面的代码被存储在一个名为 test.bat 的文件里，那我们这样调用它：

```shell
test.bat 10 20 30
```

如果我们像下面这样运行该文件：

```shell
test.bat 10 20 30 40
```

那么，两次打印的结果都是如下显示的这样，第二次运行时的第 4 个值将被忽略。

```shell
10
20
30
请按任意键继续. . .
```

# Set 命令

变量初始化的另一种方式是通过“set”命令，以下是SET命令的语法：

`set /a variable-name=value`

* variable-name ：要设置的变量名
* value ：给变量设置的值
* /a ：如果该值需要数值性质（可以对后面的值进行计算，如果值中包含运算符），需要使用该开关

下面的示例显示了该命令使用的简单方法：

```shell
@echo off 
set message=Hello World 
echo %message%
```

代码说明：

* 定义了一个名为 message 的变量，并给它设置值：Hello World
* 显示变量的值。注意：%是成对出现的

程序输出如下：

```shell
Hello World
```

## 数字类型的值

在批处理脚本中，也可以定义一个变量来保存一个数值。这可以通过使用/A开关来完成。

下面的代码演示了使用/A开关设置数值的简单方法。

```shell
@echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% + %b% 
echo %c%
```

代码说明：

* 首先给两个变量设置了值，a 为 5，b 为 10
* 将这两个变量的值相加，然后将结果存储在 c 中
* 最终，打印出变量 c 的值

上述代码的结果为：15

所有算术运算符都可以在批处理文件中起作用。下面的示例显示批处理文件中算术运算符的使用：

```shell
@echo off 
SET /A a = 5 
SET /A b = 10 
SET /A c = %a% + %b% 
echo %c% 
SET /A c = %a% - %b% 
echo %c% 
SET /A c = %b% / %a% 
echo %c% 
SET /A c = %b% * %a% 
echo %c%
```

运行结果如下：

```shell
15 
-5 
2 
50
```

> 批处理中只支持整数的算数运算

# 局部变量和全局变量

在任何编程语言中，都有一个选项将变量标记为具有某种范围，即可以访问它们的代码部分。通常，具有全局作用域的变量可以从程序的任何地方访问，而本地作用域变量有一个可以访问它们的定义边界。

DOS 脚本也有本地和全局作用域变量的定义。默认情况下，变量对整个命令提示符会话是全局的。调用SETLOCAL 命令使变量定位到脚本的作用域。在调用 SETLOCAL 之后，任何变量赋值都会在调用 ENDLOCAL、调用 Exit 或当执行到达脚本中的文件末尾(EOF)时恢复。下面的示例显示了在脚本中设置局部变量和全局变量时的差异。

```shell
@echo off 
set globalvar=5
SETLOCAL
set var=13145
set /A var=%var% + 5
echo %var%
echo %globalvar%
ENDLOCAL
echo %var%
```

上面代码的关键点说明：

* globalvar 在全局作用域范围定义的，在整个脚本中都是可用的
* var 变量是在本地作用域中定义的，因为它包含在 SETLOCAL 和 ENDLOCAL 块之间。因此，只要执行 ENDLOCAL 语句，这个变量就会被销毁

代码输出如下：

```shell
13150
5
ECHO 处于关闭状态。
```

## 使用环境变量

如果一个变量在多个批处理文件中都有使用，那么最好使用环境变量。一旦定义了环境变量，就可以通过%符号访问它。下面的示例演示如何查看在系统上定义的 Java_HOME。Java_HOME 变量是一个关键组件，通常由多种应用程序使用。

```shell
@echo off 
echo %JAVA_HOME%
```

输出将显示 Java_HOME 目录，该目录将依赖于不同的系统。下面是输出的一个示例：

```shell
C:\Atlassian\Bitbucket\4.0.1\jre
```



